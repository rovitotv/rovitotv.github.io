<!DOCTYPE html>
<html lang="english">
<head>
        <meta charset="utf-8" />
        <title>rovitotv's blog - Todd V. Rovito</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="rovitotv's blog Atom Feed" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">rovitotv's blog </a></h1>
                <nav><ul>
                    <li><a href="/pages/about.html">About</a></li>
                    <li><a href="/category/computing.html">Computing</a></li>
                    <li><a href="/category/lego.html">Lego</a></li>
                    <li><a href="/category/research.html">Research</a></li>
                    <li><a href="/category/scouts.html">Scouts</a></li>
                    <li><a href="/category/sports.html">Sports</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/photos-from-iphone-are-flipped-on-website.html">Photos from iPhone are flipped on Website</a></h1>
<footer class="post-info">
        <abbr class="published" title="2018-01-27T22:57:00-05:00">
                Published: Sat 27 January 2018
        </abbr>
		<br />
        <abbr class="modified" title="2018-01-27T22:57:00-05:00">
                Updated: Sat 27 January 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/todd-v-rovito.html">Todd V. Rovito</a>
        </address>
<p>In <a href="/category/computing.html">Computing</a>.</p>

</footer><!-- /.post-info --><p>This has been a frustrating problem for several months with my Pelican
powered Raspberry Pi web server.  I actually thought maybe I was crazy 
because I would visit my website on my computer and everything looked
fine but then if I went to my website with iPhone/iPad some of the 
pictures were upside down.  I tried using Image Magick's convert 
command to rotate the images and that didn't fix the problem.  Finally
tonight I thought I would really dive in and focus trying to figure out
what was going on.  The first thing I tried was different Pelican themes,
maybe a responsive theme would fix my issue?  I could not get the other
themes to work so I started really looking at the images and the exif
data inside of the JPEG images.  After some searching around the web
I discovered that other people had this problem.  Basically if you
take photos with your iPhone with the volume buttons oriented up
that is really upside down.  Instead of rotating the images the iPhone
puts the information into the Exif headers of the JPEG image.  But then
it behaves differently for web browsers (both MacOS and Windows) and
iPhone/iPad.  On MacOS and Windows the images had to be rotated with
the convert and they displayed fine.  But then on iPhone/iPad they
would display upside down after the convert program was used to rotate
them.  Finally I was able to assemble a Python program to rotate the
image if orientation is set then to strip out all the exif data for
presentation on the web.  Here is the program:</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ExifTags</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="s2">&quot;--filename&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store&quot;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;processing file: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">args</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
    <span class="c1"># this code below will rotate the image if it needs to be rotated</span>
    <span class="k">for</span> <span class="n">orientation</span> <span class="ow">in</span> <span class="n">ExifTags</span><span class="o">.</span><span class="n">TAGS</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">ExifTags</span><span class="o">.</span><span class="n">TAGS</span><span class="p">[</span><span class="n">orientation</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Orientation&#39;</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="n">exif</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">_getexif</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">exif</span><span class="p">[</span><span class="n">orientation</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">180</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;rotated image 180&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">exif</span><span class="p">[</span><span class="n">orientation</span><span class="p">]</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
        <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">270</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;rotated image 270&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">exif</span><span class="p">[</span><span class="n">orientation</span><span class="p">]</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
        <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;rotated image 90&quot;</span><span class="p">)</span>

    <span class="c1"># now we need to strip out the exif all together by saving</span>
    <span class="c1"># to a new image without exif</span>
    <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">getdata</span><span class="p">())</span>
    <span class="n">image_without_exif</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="n">image</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="n">image_without_exif</span><span class="o">.</span><span class="n">putdata</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">image_without_exif</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
</pre></div>


<p>Then be careful that you clear your web cache so the same
upside down image does not reload.  Hopefully this will save
you some time!</p>                </article>
            </aside><!-- /#featured -->
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">

            <li><article class="hentry">
                <header>
                    <h1><a href="/2017-2018-first-lego-league-district-results-for-steve.html" rel="bookmark"
                           title="Permalink to 2017 - 2018 First Lego League District Results for Steve">2017 - 2018 First Lego League District Results for Steve</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-01-07T19:45:00-05:00">
                Published: Sun 07 January 2018
        </abbr>
		<br />
        <abbr class="modified" title="2018-01-07T19:45:00-05:00">
                Updated: Sun 07 January 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/todd-v-rovito.html">Todd V. Rovito</a>
        </address>
<p>In <a href="/category/lego.html">Lego</a>.</p>

</footer><!-- /.post-info -->                <p>Steve 2017 - 2018 First Lego League District Results at Wright State University</p>
                <a class="readmore" href="/2017-2018-first-lego-league-district-results-for-steve.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/2017-2018-first-lego-league-regional-results-for-steve.html" rel="bookmark"
                           title="Permalink to 2017 - 2018 First Lego League Regional Results for Steve">2017 - 2018 First Lego League Regional Results for Steve</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-12-09T20:45:00-05:00">
                Published: Sat 09 December 2017
        </abbr>
		<br />
        <abbr class="modified" title="2017-12-09T20:45:00-05:00">
                Updated: Sat 09 December 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/todd-v-rovito.html">Todd V. Rovito</a>
        </address>
<p>In <a href="/category/lego.html">Lego</a>.</p>

</footer><!-- /.post-info -->                <p>Steve 2017 - 2018 First Lego League Regional Results at Emmerson</p>
                <a class="readmore" href="/2017-2018-first-lego-league-regional-results-for-steve.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/passing-of-everett-sherron-a-true-american-hero.html" rel="bookmark"
                           title="Permalink to Passing of Everett Sherron A True American Hero">Passing of Everett Sherron A True American Hero</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-06-10T20:37:00-04:00">
                Published: Sat 10 June 2017
        </abbr>
		<br />
        <abbr class="modified" title="2017-06-10T20:37:00-04:00">
                Updated: Sat 10 June 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/todd-v-rovito.html">Todd V. Rovito</a>
        </address>
<p>In <a href="/category/scouts.html">Scouts</a>.</p>

</footer><!-- /.post-info -->                <p>Overview of Mr. Sherron's Work In Boy Scouts with Troop 18/718</p>
                <a class="readmore" href="/passing-of-everett-sherron-a-true-american-hero.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/securing-raspberry-pi-ssh-with-auto-ssh-fail.html" rel="bookmark"
                           title="Permalink to Securing Raspberry Pi SSH with Auto SSH Fail">Securing Raspberry Pi SSH with Auto SSH Fail</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-04-02T12:00:00-04:00">
                Published: Sun 02 April 2017
        </abbr>
		<br />
        <abbr class="modified" title="2017-04-02T12:00:00-04:00">
                Updated: Sun 02 April 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/todd-v-rovito.html">Todd V. Rovito</a>
        </address>
<p>In <a href="/category/computing.html">Computing</a>.</p>

</footer><!-- /.post-info -->                <p>Secure SSH on a Raspberry Pi with this simple Python script</p>
                <a class="readmore" href="/securing-raspberry-pi-ssh-with-auto-ssh-fail.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/efficient-generation-of-image-chips-for-training-deep-learning-algorithms.html" rel="bookmark"
                           title="Permalink to Efficient Generation of Image Chips for Training Deep Learning Algorithms">Efficient Generation of Image Chips for Training Deep Learning Algorithms</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-03-11T12:00:00-05:00">
                Published: Sat 11 March 2017
        </abbr>
		<br />
        <abbr class="modified" title="2017-03-11T12:00:00-05:00">
                Updated: Sat 11 March 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/todd-v-rovito.html">Todd V. Rovito</a>
        </address>
<p>In <a href="/category/research.html">Research</a>.</p>

</footer><!-- /.post-info -->                <p>Abstract: Training deep convolutional networks for satellite or aerial image
analysis often requires a large amount of training data. For a more robust
algorithm, training data need to have variations not only in the background and
target, but also radiometric variations in the image such as shadowing,
illumination changes, atmospheric …</p>
                <a class="readmore" href="/efficient-generation-of-image-chips-for-training-deep-learning-algorithms.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/2016-2017-first-lego-league-district-results-for-beees.html" rel="bookmark"
                           title="Permalink to 2016 - 2017 First Lego League District Results for BEEES">2016 - 2017 First Lego League District Results for BEEES</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-12-11T22:32:00-05:00">
                Published: Sun 11 December 2016
        </abbr>
		<br />
        <abbr class="modified" title="2016-12-11T22:32:00-05:00">
                Updated: Sun 11 December 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/todd-v-rovito.html">Todd V. Rovito</a>
        </address>
<p>In <a href="/category/lego.html">Lego</a>.</p>

</footer><!-- /.post-info -->                <p>BEEES 2016 - 2017 First Lego League Regional Results at Yellow Springs High School</p>
                <a class="readmore" href="/2016-2017-first-lego-league-district-results-for-beees.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/raspberry-pi-touch-screen-with-chromium-web-browser.html" rel="bookmark"
                           title="Permalink to Raspberry PI Touch Screen with Chromium Web Browser">Raspberry PI Touch Screen with Chromium Web Browser</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-03-12T23:53:00-05:00">
                Published: Sat 12 March 2016
        </abbr>
		<br />
        <abbr class="modified" title="2016-03-12T23:53:00-05:00">
                Updated: Sat 12 March 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/todd-v-rovito.html">Todd V. Rovito</a>
        </address>
<p>In <a href="/category/computing.html">Computing</a>.</p>

</footer><!-- /.post-info -->                <p class="first last">Experimenting with the Raspberry PI Touch Screen running Chromium</p>

                <a class="readmore" href="/raspberry-pi-touch-screen-with-chromium-web-browser.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/trying-out-os-x-fuse-and-sshfs-connected-to-raspberry-pi.html" rel="bookmark"
                           title="Permalink to Trying out OS X Fuse and SSHFS connected to Raspberry Pi">Trying out OS X Fuse and SSHFS connected to Raspberry Pi</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-02-06T23:53:00-05:00">
                Published: Sat 06 February 2016
        </abbr>
		<br />
        <abbr class="modified" title="2016-02-06T23:53:00-05:00">
                Updated: Sat 06 February 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/todd-v-rovito.html">Todd V. Rovito</a>
        </address>
<p>In <a href="/category/computing.html">Computing</a>.</p>

</footer><!-- /.post-info -->                <p>Experiments with OS X Fuse and SSHFS connected to Raspberry Pi</p>
                <a class="readmore" href="/trying-out-os-x-fuse-and-sshfs-connected-to-raspberry-pi.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/2015-2016-first-lego-league-district-results-for-the-lego-creepers.html" rel="bookmark"
                           title="Permalink to 2015 - 2016 First Lego League District Results for The Lego Creepers">2015 - 2016 First Lego League District Results for The Lego Creepers</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-01-16T22:06:00-05:00">
                Published: Sat 16 January 2016
        </abbr>
		<br />
        <abbr class="modified" title="2016-01-16T22:06:00-05:00">
                Updated: Sat 16 January 2016
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/todd-v-rovito.html">Todd V. Rovito</a>
        </address>
<p>In <a href="/category/lego.html">Lego</a>.</p>

</footer><!-- /.post-info -->                <p>Lego Creepers 2015 - 2016 First Lego League District Results at</p>
                <a class="readmore" href="/2015-2016-first-lego-league-district-results-for-the-lego-creepers.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>
                </ol><!-- /#posts-list -->
<p class="paginator">
    Page 1 / 3
        <a href="/author/todd-v-rovito2.html">&raquo;</a>
</p>
                </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://www.raspberrypi.org">Raspberry Pi</a></li>
                            <li><a href="http://teamafrl.afciviliancareers.com">AFRL</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="https://twitter.com/rovitotv">Twitter</a></li>
                            <li><a href="https://github.com/rovitotv">GitHub</a></li>
                            <li><a href="https://www.youtube.com/channel/UCBl6ggrOjOtyoyXsdNvKouA">YouTube</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>